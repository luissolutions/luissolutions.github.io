<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <title>Walmart Security Technology â€“ Project Tracker</title>
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <script type="module" src="../apps/assets/js/login.js" defer></script>
  <link rel="stylesheet" href="./assets/css/walmart-tracker.css" />
</head>

<body>

  <header>
    <img src="assets/img/walmart-logo.webp" alt="" class="header-logo">

    <div class="header-login">
      <div id="login-section">
        <form id="login-form" class="login-form">
          <input type="email" id="username" placeholder="Email" required>
          <input type="password" id="password" placeholder="Password" required>
          <button type="submit" class="login-btn">Login</button>
        </form>

        <button id="logout" class="logout-btn" style="display: none;">Logout</button>
      </div>
    </div>

  </header>

  <main>
    <div class="app-shell">
      <!-- SIDEBAR -->
      <aside class="sidebar card">
        <div class="sidebar-header">
          <h1>Tech Sheet â€“ Project Tracker</h1>
          <div class="subtitle">
            Track Walmart CCTV & Alarm scope, alarm points, and cameras for this job.
          </div>

          <div class="project-row">
            <input id="projectNameInput" placeholder="Project (e.g. WM1234 â€“ City)">
            <button id="setProjectBtn" type="button">Set</button>
          </div>
          <button id="clearProjectBtn" type="button">Clear</button>
          <div class="current-project-tag">
            Current project: <code id="currentProjectLabel">(none)</code>
          </div>

          <div class="project-links-card">
            <div class="project-links-header">Project links</div>

            <!-- Always visible -->
            <ul id="projectLinksList" class="project-links-list"></ul>

            <!-- Only visible in admin mode -->
            <form id="projectLinksForm" class="project-links-form hidden">
              <input type="text" id="projectLinkTitle" placeholder="Title" class="project-link-input">
              <input type="url" id="projectLinkUrl" placeholder="URL (https://...)" class="project-link-input">
              <button type="submit" class="project-link-add-btn">Add</button>
            </form>
          </div>

          <div class="progress-row">
            <span>Overall scope complete</span>
            <span id="overallPercent">0%</span>
          </div>
          <div class="progress-bar-track">
            <div class="progress-bar-fill" id="overallBar"></div>
          </div>
          <div class="progress-row">
            <span>Cameras</span>
            <span id="sidebarCameraSummary">0 done / 0 total</span>
          </div>

        </div>

        <div class="pill-list" id="sectionList"></div>
      </aside>

      <!-- MAIN CONTENT -->
      <main class="main card">
        <div class="main-header">
          <div id="sectionTitle">Select a section</div>
          <div id="sectionMeta"></div>

          <div class="section-progress-wrapper" id="sectionProgressWrapper">
            <span class="section-progress-label" id="sectionCountLabel"></span>
            <div class="progress-bar-track">
              <div class="progress-bar-fill" id="sectionBar"></div>
            </div>
          </div>
        </div>

        <ul class="task-list" id="taskList"></ul>

        <div class="notes-block" id="notesBlock">
          <label for="sectionNotes">
            Section notes
            <span class="section-tag">
              Scope ref: <code id="sectionScopeCode"></code>
            </span>
          </label>
          <textarea id="sectionNotes"
            placeholder="Add site-specific details, deviations from prints, AHJ notes, or anything you want to remember for this section..."></textarea>
          <small>Notes are saved automatically to Firebase for the current project.</small>
        </div>

        <hr>

        <div>
          <button type="button" class="detail-tab" data-panel="alarm">Alarm Points</button>
          <button type="button" class="detail-tab" data-panel="cameras">Cameras</button>
          <button type="button" class="detail-tab" data-panel="speakers">Speakers</button>
        </div>

        <div>
          <input type="checkbox" id="enableImageEditCheckbox">
          <span>Enable editing of image notes</span>
        </div>

        <!-- Alarm points panel -->
        <div id="alarmPanel" class="detail-panel hidden">
          <div>
            Track each alarm point: number, name, completed, and optional photos with notes.
          </div>

          <!-- Hide-done checkbox for alarms -->
          <div>
            <label >
              <input type="checkbox" id="hideDoneAlarms">
              <span>Hide done alarm points</span>
            </label>
          </div>

          <form id="alarmForm" >
            <input type="number" id="alarmPointNumber" placeholder="Point #" min="0">
            <input type="text" id="alarmPointName" placeholder="Point name / description">
            <button type="submit">Add / Update</button>
          </form>

          <table class="detail-table" id="alarmTable">
            <thead>
              <tr>
                <th>Point #</th>
                <th>Name</th>
                <th>Done</th>
                <th>Image(s)</th>
                <th>Notes</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>
        </div>

<!-- Cameras panel -->
<div id="cameraPanel" class="detail-panel hidden">
  <div>
    Track each camera: ID, name/location, completion, photos, and camera-level notes.
  </div>

  <!-- Hide-done checkbox for cameras -->
  <div style="margin:6px 0;">
    <label style="display:flex;align-items:center;gap:4px;color:var(--text-muted);">
      <input type="checkbox" id="hideDoneCameras">
      <span>Hide done cameras</span>
    </label>
  </div>

  <!-- ðŸ”Ž Camera search -->
  <div class="camera-search-row">
    <input
      type="text"
      id="cameraSearchInput"
      placeholder="Search cameras (id, name, IP, MAC, notes, switch)â€¦"
    >
    <small class="camera-search-hint">
      Use things like: <code>ip:192.168.85</code> <code>name:vestibule</code> <code>-done</code>
    </small>
  </div>

  <form id="cameraForm" style="display:flex;flex-wrap:wrap;gap:6px;margin-bottom:8px;">
    <!-- existing form inputs... -->
  </form>

          <form id="cameraForm">
            <input type="text" id="cameraId" placeholder="Camera ID (Cable # / CAM-01, etc.)">
            <input type="text" id="cameraName" placeholder="Camera name / location">
            <button type="submit">Add / Update</button>
          </form>

          <!-- NEW: column visibility toggles -->
          <div class="camera-column-toggles">
            <span>Show fields:</span>
            <label><input type="checkbox" id="toggleCameraIp"> IP</label>
            <label><input type="checkbox" id="toggleCameraMac"> MAC</label>
            <label><input type="checkbox" id="toggleCameraSwitch"> Switch / Port</label>
          </div>
          <div style="overflow: auto;">
            <table class="detail-table" id="cameraTable">
              <thead>
                <tr>
                  <th>Camera ID</th>
                  <th>Name</th>
                  <th class="col-camera-ip">IP</th>
                  <th class="col-camera-mac">MAC</th>
                  <th class="col-camera-switch">Switch / Port</th>
                  <th>Done</th>
                  <th>Image(s)</th>
                  <th>Notes</th>
                  <th>Actions</th>
                </tr>
              </thead>
              <tbody></tbody>
            </table>
          </div>
          <div>
            <button type="button" id="importCameraCsvBtn">
              Import Camera List (Cable Sheet CSV)
            </button>
            <button type="button" id="exportCameraCsvBtn">
              Export Camera Table (Cable Sheet CSV)
            </button>
          </div>
        </div>

        <!-- Speakers panel -->
        <div id="speakersPanel" class="detail-panel hidden">
          <div>
            Track speakers: number, name/location, and notes.
          </div>

          <form id="speakerForm">
            <input type="number" id="speakerNumber" placeholder="Speaker #" min="0">
            <input type="text" id="speakerName" placeholder="Speaker name / location">
            <button type="submit">Add / Update</button>
          </form>

          <table class="detail-table" id="speakerTable">
            <thead>
              <tr>
                <th>Speaker #</th>
                <th>Name</th>
                <th>Image(s)</th>
                <th>Notes</th>
                <th>Actions</th>
              </tr>
            </thead>
            <tbody></tbody>
          </table>

        </div>

        <!-- hidden file input for both alarm + camera + task uploads -->
        <input type="file" id="imageUploadInput" accept="image/*" class="hidden">

        <!-- hidden file input for camera CSV import -->
        <input type="file" id="cameraCsvInput" accept=".csv" class="hidden">

      </main>
    </div>
  </main>

  <footer>
    <div class="current-project-tag">
      Data path: <code id="currentBasePathLabel">public</code>
    </div>
  </footer>
<script src="../apps/assets/js/search.js"></script>

  <script type="module" src="assets/js/walmart-tracker.js"></script>
</body>

</html>