<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Real-Time Speedwriting Converter</title>
    <style>
        textarea {
            width: 90%;
            height: auto;
            /* Set initial height to auto */
            overflow-y: hidden;
            /* Hide vertical scrollbar */
            margin: 10px;
            padding: 10px;
            font-size: 16px;
        }

        body {
            text-align: center;
            font-family: Arial, sans-serif;
        }
    </style>
</head>

<body>
    <h1>Real-Time Speedwriting Converter</h1>
    <textarea id="standardText" placeholder="Start typing here..."></textarea>
    <textarea id="shorthandText" placeholder="Shorthand will appear here..."></textarea>
    <button id="copyStandardText">Copy Standard Text</button>
    <button id="copyShorthandText">Copy Shorthand Text</button>
    <button id="saveToFile">Save to File</button>

    <script>
        document.addEventListener('DOMContentLoaded', setupEventListeners);

        function setupEventListeners() {
            document.getElementById('standardText').addEventListener('input', handleStandardInput);
            document.getElementById('shorthandText').addEventListener('input', handleShorthandInput);
            document.getElementById('copyStandardText').addEventListener('click', () => copyToClipboard('standardText'));
            document.getElementById('copyShorthandText').addEventListener('click', () => copyToClipboard('shorthandText'));
            document.getElementById('saveToFile').addEventListener('click', () => saveTextToFile('shorthandText', "shorthand.txt"));
        }

        function autoResizeTextarea(id) {
            const textarea = document.getElementById(id);
            textarea.style.height = 'auto'; // Reset height to recalculate
            textarea.style.height = textarea.scrollHeight + 'px'; // Set new height
        }

        function handleStandardInput() {
            const text = this.value;
            document.getElementById('shorthandText').value = convertToShorthand(text);
            autoResizeTextarea('standardText'); // Resize standard text area
            autoResizeTextarea('shorthandText'); // Resize shorthand text area
        }

        function handleShorthandInput() {
            const shorthandText = this.value;
            document.getElementById('standardText').value = convertToStandard(shorthandText);
            autoResizeTextarea('standardText'); // Resize standard text area
            autoResizeTextarea('shorthandText'); // Resize shorthand text area
        }

        function convertToShorthand(text) {
            return text.split(' ').map(word => replaceCommonWords(applyAdditionalRules(removeVowels(word)))).join(' ');
        }

        function convertToStandard(shorthand) {
            return shorthand.split(' ').map(word => applyReverseRules(reverseCommonWords(word))).join(' ');
        }

        function removeVowels(word) {
            return word.charAt(0) + word.slice(1).replace(/[aeiou]/ig, '');
        }

        function replaceCommonWords(word) {
            const replacements = { 'and': '&', 'the': 'th', 'you': 'u', 'because': 'bcz', 'before': 'b4' };
            return replacements[word.toLowerCase()] || word;
        }

        function applyAdditionalRules(word) {
            return word.replace(/ing\b/ig, 'n').replace(/([a-z])\1/ig, '$1').replace(/ph/ig, 'f');
        }

        function reverseCommonWords(word) {
            const reverseReplacements = { '&': 'and', 'th': 'the', 'u': 'you', 'bcz': 'because', 'b4': 'before' };
            return reverseReplacements[word.toLowerCase()] || word;
        }

        function applyReverseRules(word) {
            return word.replace(/n\b/ig, 'ing'); // Add more rules as needed
        }

        function copyToClipboard(elementId) {
            const text = document.getElementById(elementId).value;
            navigator.clipboard.writeText(text).then(() => alert('Copied to clipboard')).catch(err => alert('Error in copying text: ' + err));
        }

        function saveTextToFile(elementId, filename) {
            const text = document.getElementById(elementId).value;
            const blob = new Blob([text], { type: "text/plain" });
            const anchor = document.createElement("a");
            anchor.download = filename;
            anchor.href = window.URL.createObjectURL(blob);
            anchor.click();
            window.URL.revokeObjectURL(anchor.href);
        }

    </script>
</body>

</html>